<!--
  ~ Copyright (c) 2015-2017, Dell EMC
  ~
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~
  ~  http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  -->
<div class="breadcrumb-wrapper">
    <!-- History button -->
    <div class="btn-group history" xmlns:th="http://www.w3.org/1999/xhtml">
      <button id="historyBtn" type="button" class="btn btn-lg btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        <span class="caret"></span>
        <span class="sr-only">Toggle Dropdown</span>
      </button>
      <ul class="dropdown-menu">
         
        <li class="active"><a href="#" th:text="${collectionAndDataObject.path}"></a></li>
          <li><a aria-label="user home directory" class="home" th:href="@{${urlMap.URL_HOME_COLLECTION_USER}}" th:text="'Home ('+${homeCollectionName}+')'"></a>
          </li>
      </ul>
    </div>

    <div id="editable-path">
    <!-- Current Collections Table -->
        <div id="current-path">
            <ol class="breadcrumb">
                <th:block th:if="${breadcrumb.items.size()} le 3" th:each="breadcrumbItem, iterStat: ${breadcrumb.items}">
                    <th:block th:if="${iterStat.index lt (breadcrumb.items.size()-1)}">
                        <li class="hidden-xs hidden-sm">
                            <a  href="#" aria-label="'path breadcrumb for:' + ${ breadcrumbItem.path }"
                                th:text="${breadcrumbItem.name}"
                                th:title="${breadcrumbItem.path}"
                                th:onclick="'javascript:positionBrowserToPath(\'' + ${ breadcrumbItem.path } + '\');'"
                            >
                            </a>
                        </li>
                    </th:block>
                    <th:block th:if="${iterStat.index eq (breadcrumb.items.size()-1)}">
                        <li class="collections-view">
                        <span th:if="${collectionAndDataObject.path != '/'}"
                              th:text="${ collectionAndDataObject.name }"
                              th:title="${ collectionAndDataObject.path }">
                        </span>
                        </li>
                    </th:block>
                </th:block>
                <th:block th:if="${breadcrumb.items.size()} gt 3">
                    <li>...</li>
                    <li class="hidden-sm hidden-xs hidden-md">
                        <a  href="#" aria-label="'path breadcrumb for:' + ${breadcrumb.items[breadcrumb.items.size()-3].name}"
                            th:text="${breadcrumb.items[breadcrumb.items.size()-3].name}"
                            th:title="${breadcrumb.items[breadcrumb.items.size()-3].path}"
                            th:onclick="'javascript:positionBrowserToPath(\'' + ${ breadcrumb.items[breadcrumb.items.size()-3].path } + '\');'"
                        >
                        </a>
                    </li>
                    <li class="hidden-xs hidden-sm">
                        <a  href="#"
                            th:text="${breadcrumb.items[breadcrumb.items.size()-2].name}"
                            th:title="${breadcrumb.items[breadcrumb.items.size()-2].path}"
                            th:onclick="'javascript:positionBrowserToPath(\'' + ${ breadcrumb.items[breadcrumb.items.size()-2].path } + '\');'"
                        >
                        </a>
                    </li>
                    <li class="collections-view">
                    <span th:if="${collectionAndDataObject.path != '/'}"
                          th:text="${ collectionAndDataObject.name }"
                          th:title="${ collectionAndDataObject.path }">
                    </span>
                    </li>
                </th:block>
            </ol>
        </div>
        <div id="current-path-property" class="hidden">
            <ol class="breadcrumb info">
                <th:block th:if="${collectionAndDataObject.isCollection()}">
                    <li>
                        <a class="collection" href="#" aria-label="'info for:' + ${ collectionAndDataObject.name }">
                            <span th:if="${collectionAndDataObject.path != '/'}"
                                  th:text="${ collectionAndDataObject.name }"
                                  th:title="${ collectionAndDataObject.path }">
                            </span>
                        </a>
                    </li>
                </th:block>
            </ol>
        </div>
        <div class="hidden" id="navigationBar"><input type="text" id="navigationInput" th:value="${collectionAndDataObject.path}" placeholder="Enter a non-empty valid path" />
        </div>
        <button href="#" class="pull-right btn btn-sm btn-primary hidden" id="navigationBarGo"><i class="fa fa-check" aria-hidden="true"></i></button>
        <button href="#" class="pull-right btn btn-sm btn-default hidden" id="navigationBarCancel"><i class="fa fa-remove" aria-hidden="true"></i></button>
    </div>

	<!-- <a id="breadcrumbStar" class="btn-favorite" th:onclick="${starredPath}? 'javascript:unstarPath(\'' + ${collectionAndDataObject.path} + '\');' : 'javascript:starPath(\'' + ${collectionAndDataObject.path} + '\');'" href="#"
		aria-label="starred object" data-toggle="popover" data-placement="left" data-trigger="manual" data-content="" th:title="${starredPath}?#{collections.favorite.unmark.button.tooltip}:#{collections.favorite.button.tooltip}" >
		<i th:class="${starredPath}? 'fa fa-star bm-checked' : 'fa fa-star bm-unchecked'" aria-hidden="true"></i>
	</a> -->

</div>
<script th:inline="javascript">
/*<![CDATA[*/
    $(document).ready(function(){
    	// Add tooltip on Favorite button
       /*  $('#breadcrumbStar').tooltip({
   			trigger: 'hover',
       		placement:'top',
   		}); */
        $('#breadcrumbHome').tooltip();
     	// Add tooltip on Options menu
        $('#breadcrumbOptionsMenu').tooltip({
    		content:[[#{collections.menu.options.tooltip}]],
   			trigger: 'hover',
       		placement: 'top',
   		}); 
     	// Add tooltip on History button
        $('#historyBtn').tooltip({
   			trigger: 'hover',
       		placement: 'top',
   		}); 
     	// Add tooltip on Back button
        $('#backBtn').tooltip({
   			trigger: 'hover',
       		placement: 'top',
       		container: 'body'
   		}); 
     	// Add tooltip on Forward button
        $('#forwardBtn').tooltip({
   			trigger: 'hover',
       		placement: 'top',
       		container: 'body'
   		});
    });
    
	$(document).click(function(e){
		if(!$(e.target).is('.breadcrumb i.fa.fa-star')){
			//$('#breadcrumbStar').popover("hide");
		}else{
			e.stopPropagation();
			e.preventDefault();
		}
	});
	$('.breadcrumb').click(function(e){
		if(!$(e.target).is('ol.breadcrumb li a') && !$(e.target).is('i.fa.fa-star') && !$(e.target).is('i.fa.fa-home') && !$(e.target).parents('#breadcrumbOptions').length){
			$('#current-path').addClass("hidden");
			//$('#breadcrumbStar').addClass("hidden");
			$('#breadcrumbOptionsMenu').addClass("hidden");
			$('#navigationBar').removeClass("hidden");
			$('#navigationBarGo').removeClass("hidden");
			$('#navigationBarCancel').removeClass("hidden");
			$('#navigationInput').focus().select();
		}
	});
	$('#navigationInput').keyup(function(e){
		if(e.keyCode == 13){
			if($('#navigationInput').val().trim() == '') return;
			getSubDirectories($('#navigationInput').val());
		}
		if(e.keyCode == 27){
			$('#navigationInput').val([[${collectionAndDataObject.path}]]);
			$('#current-path').removeClass("hidden");
			$('#navigationBar').addClass("hidden");
			$('#navigationBarCancel').addClass("hidden");
			$('#navigationBarGo').addClass("hidden");
			//$('#breadcrumbStar').removeClass("hidden").addClass("visible");
			$('#breadcrumbOptionsMenu').removeClass("hidden").addClass("visible");

		}
	});

	$('#navigationBarGo').click(function(e){
		e.stopPropagation();
		e.preventDefault();
		if($('#navigationInput').val().trim() == '') return;
		getSubDirectories($('#navigationInput').val());
	});
	$('#navigationBarCancel').click(function(e){
		e.stopPropagation();
		e.preventDefault();
		$('#navigationInput').val([[${collectionAndDataObject.path}]]);
			$('#current-path').removeClass("hidden");
			$('#navigationBar').addClass("hidden");
			$('#navigationBarGo').addClass("hidden");
			$('#navigationBarCancel').addClass("hidden");
			$(".current-path .breadcrumb").css("background-color", "#ffffff");
			//$('#breadcrumbStar').removeClass("hidden").addClass("visible");
			$('#breadcrumbOptionsMenu').removeClass("hidden").addClass("visible");
	});
	$("#editable-path").mouseover(function(e) {
        if (!$(e.target).is('a')) {
            $("#current-path .breadcrumb").css("background-color", "#f7fafe");
        }
    });
    $("#editable-path").mouseout(function(e) {
       if (!$(e.target).is('a')) {
         $("#current-path .breadcrumb").css("background-color", "#ffffff");
      }
    });
	
/*]]>*/
</script>
